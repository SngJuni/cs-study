# 로드밸런싱 & CDN

### 로드밸런싱(Load Balancing)

---

**정의**

- 로드밸런싱은 여러 대의 서버에 **네트워크 트래픽을 균등하게 분산시켜 서비스의 성능, 가용성, 확장성을 높이는 기술**이다.
- 단일 서버에 부하가 집중되는 것을 방지하여 **장애를 줄이고 응답 속도를 향상**시킨다.

**필요성**

- 서비스 사용자가 늘어나면 한 서버의 처리량(Capacity)을 초과할 수 있다.
- 단일 서버에 의존하면 장애 시 전체 서비스가 중단된다.
    
    → 로드밸런서는 클라이언트 요청을 여러 서버로 분산해 이런 **Single Point of Failure** 문제를 해결한다.
    

**동작 원리**

1. 클라이언트는 서비스의 공용 IP(가상 IP, VIP)로 요청을 전송
2. 로드밸런서는 서버 풀(pool) 내의 여러 서버 중 하나를 선택
3. 선택된 서버로 요청을 전달 → 서버는 응답을 클라이언트에 반환
4. 로드밸런서는 서버 상태(Health Check)를 주기적으로 모니터링 하여 장애 서버는 자동으로 제외(Failover)

**부하 분산 알고리즘**

- **Round Robin** : 순차적으로 서버에 요청 배분 (기본, 단순)
- **Least Connection** : 현재 연결 수가 가장 적은 서버로 전달
- **IP Hash** : 클라이언트 IP 기반으로 특정 서버에 고정 연결
- **Weighted Round Robin** : 서버의 성능에 따라 가중치 부여
- **Dynamic Load Balancing** : 실시간 트래픽, CPU, 메모리 사용량 고려

**종류**

- **L4 로드밸런서 (전송 계층)**
    - TCP/UDP 포트 기반 라우팅
    - 빠르고 효율적, 세션 정보는 인식하지 않음
- **L7 로드밸런서 (애플리케이션 계층)**
    - HTTP/HTTPS 헤더, URL, 쿠키 기반 분산
    - 세션 유지, 캐싱, SSL 종료(TLS Offloading) 가능

**장점**

- 트래픽 균형 유지 → 응답속도 향상
- 장애 서버 자동 제외 → 고가용성 확보
- 서버 증설 시 수평 확장 가능 (Scalability)
- 유지보수 중에도 서비스 중단 최소화

### CDN(Content Delivery Network)

---

**정의**

- CDN은 전 세계에 분산된 **엣지 서버(Edge Server)** 를 이용해 사용자가 가까운 서버에서 콘텐츠를 다운로드하도록 하는 **분산 콘텐츠 전송 네트워크**이다.
- 웹 페이지, 이미지, 동영상, 정적 파일 등의 전송 속도를 높이는 역할을 한다.

**필요성**

- 모든 사용자가 원본 서버(Origin Server)에 직접 접근하면 지리적 거리, 네트워크 병목으로 인해 지연(latency)이 증가한다.
- CDN은 원본 콘텐츠를 여러 지역에 미리 복제(Cache)하여, 사용자와 물리적으로 가까운 서버에서 빠르게 제공한다.

**동작 원리**

1. 사용자가 `www.example.com`에 요청 → DNS가 **CDN 네임서버**로 연결
2. CDN은 요청자의 위치(IP 기준)를 분석 → 가장 가까운 Edge 서버를 선택
3. Edge 서버에 캐시된 콘텐츠가 있으면 바로 응답
4. 캐시가 없을 경우 Origin 서버에서 데이터를 가져와 캐시에 저장 후 전달
5. 다음 요청부터는 캐시에서 빠르게 응답

**CDN 구성 요소**

- **Origin Server** : 실제 콘텐츠가 저장된 중앙 서버
- **Edge Server** : 전 세계에 분산된 캐시 서버
- **PoP(Point of Presence)** : CDN 엣지 서버가 위치한 물리적 지점

**장점**

- 지연시간 감소, 트래픽 부하 분산
- 원본 서버 부하 감소 및 안정성 향상
- DDoS 같은 공격에 대한 완충 역할
- 글로벌 서비스 품질 균일화

## 관련 면접 질문

- 로드밸런싱이 필요한 이유는 무엇인가요?
    - 서버 과부하 방지, 장애 시 자동 복구, 트래픽 확장을 위한 구조적 안정성 확보를 위해 필요합니다.
- CDN이 성능을 향상시키는 이유는?
    - 사용자의 지리적 위치와 가까운 Edge 서버에서 데이터를 전달해 네트워크 지연을 줄입니다.
- CDN과 로드밸런싱의 차이는?
    - 로드밸런싱은 “요청을 어디로 보낼지”, CDN은 “콘텐츠를 어디서 받을지”에 초점이 있습니다.
- CDN이 원본 서버보다 보안상 유리한 이유는?
    - CDN이 중간 계층으로 작동해 직접적인 원본 노출을 막고, DDoS 공격 시 트래픽을 흡수하거나 차단할 수 있기 때문입니다.