# 문맥 교환 (Context Switch)

## 정의

문맥 교환은 CPU가 현재 실행 중인 프로세스(또는 스레드)의 상태를 저장하고, 다른 프로세스의 상태를 불러와 실행을 전환하는 과정을 말합니다.

운영체제가 멀티태스킹을 지원하기 위해 반드시 필요한 핵심 기능이에요.

## 필요한 이유

- 여러 프로세스가 동시에 실행되는 것처럼 보이도록 하기 위해
- CPU 자원을 공정하게 배분하기 위해 (스케줄러가 관리)
- I/O 요청 등으로 프로세스가 대기 상태에 들어갈 때 CPU 낭비를 막기 위해

## 수행 과정

1. 현재 실행 중인 프로세스 상태 저장
    - 프로그램 카운터(PC), 레지스터 값, 스택 포인터 등 CPU 상태를 PCB(Process Control Block)에 저장
2. 새로운 프로세스 선택
    - 스케줄러가 다음에 실행할 프로세스를 결정
3. 새로운 프로세스 상태 복원
    - 선택된 프로세스의 PCB에서 상태를 복원해 CPU에서 실행

## 저장/복원되는 정보

- 프로세스 카운터(PC) : 다음에 실행할 명령어 위치
- CPU 레지스터 값 : 연산에 쓰이던 값들
- 메모리 관리 정보 : 페이지 테이블, 세그먼트 정보 등
- 입출력 상태 : 해당 프로세스와 관련된 I/O 상태

## 특징

- 문맥 교환 자체는 순수한 오버헤드
    
    → 즉, 사용자 프로그램 실행을 직접적으로 진전시키지 않음
    
- 문맥 교환이 자주 일어나면 성능이 저하될 수 있음
- 교환 속도는 CPU와 운영체제 구현 방식에 크게 영향을 받음

## 예시

- 멀티프로그래밍 환경: 프로세스 A 실행 → I/O 요청으로 대기 → 프로세스 B 실행
- 타임 시분할 시스템: 프로세스가 CPU 할당 시간을 다 쓰면 문맥 교환 발생