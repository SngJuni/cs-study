# 🚀 TCP vs UDP (전송 계층 Transport Layer)

> OSI 7계층의 **4계층(전송 계층)** 은  
> 응용 계층에서 받은 데이터를 **세그먼트(Segment)** 단위로 나누어  
> **종단 간(end-to-end) 통신의 신뢰성**과 **효율성**을 보장한다.

---

## 🧩 1. 전송 계층의 역할

| 기능 | 설명 |
|:--|:--|
| **세그먼트화 (Segmentation)** | 상위 계층의 데이터를 일정 크기로 분할 |
| **재조립 (Reassembly)** | 수신 측에서 세그먼트를 원래 데이터로 복원 |
| **흐름 제어 (Flow Control)** | 송신 속도와 수신 속도의 균형 유지 |
| **오류 제어 (Error Control)** | 데이터 손상 시 재전송 및 확인 응답 |
| **다중화 (Multiplexing)** | 여러 응용 프로그램 간 포트 번호 기반 분리 |

---

## ⚙️ 2. TCP (Transmission Control Protocol)

> **신뢰성 있는 연결 지향형 프로토콜**

| 항목 | 설명 |
|:--|:--|
| **특징** | 연결 지향(Connection-Oriented), 신뢰성 보장 |
| **연결 과정** | 3-Way Handshake (SYN → SYN+ACK → ACK) |
| **전송 단위** | 세그먼트(Segment) |
| **흐름 제어** | 윈도우 기반 (Sliding Window) |
| **오류 제어** | ACK(응답) + 재전송 메커니즘 |
| **혼잡 제어** | 네트워크 부하에 따라 전송 속도 조절 |
| **순서 보장** | 시퀀스 번호(Sequence Number) 기반 |
| **대표 포트 번호** | HTTP(80), HTTPS(443), SMTP(25), FTP(21), SSH(22) |

---

### 📡 TCP 연결 과정 (3-Way Handshake)

```

1️⃣ 클라이언트 → 서버 : SYN
2️⃣ 서버 → 클라이언트 : SYN + ACK
3️⃣ 클라이언트 → 서버 : ACK

```

> 이 과정을 통해 **신뢰성 있는 연결이 성립**  
> 데이터 전송 종료 시에는 **4-Way Handshake** 로 연결 해제

---

### 🧠 TCP 특징 요약

- 데이터 **전송 순서 보장**
- **패킷 손실 시 재전송**
- 연결 관리 필요 → **오버헤드 존재**
- 신뢰성이 중요할 때 사용  
  → 웹, 이메일, 파일 전송 등

---

## ⚡ 3. UDP (User Datagram Protocol)

> **비연결형, 비신뢰성 프로토콜**  
> 신속한 전송이 필요한 실시간 통신에 사용

| 항목 | 설명 |
|:--|:--|
| **특징** | 비연결(Connectionless), 비신뢰성(Unreliable) |
| **전송 단위** | 데이터그램(Datagram) |
| **연결 과정** | 없음 (Handshake 불필요) |
| **흐름 제어 / 오류 제어** | 없음 (단순 전송만 수행) |
| **순서 보장** | 불가능 (수신 순서 불일치 가능) |
| **대표 포트 번호** | DNS(53), DHCP(67,68), TFTP(69), RTP, 게임, 스트리밍 |

---

### 📊 UDP 구조

```

+-------------------+
|  Source Port (16) |
+-------------------+
|  Dest Port (16)   |
+-------------------+
|  Length (16)      |
+-------------------+
|  Checksum (16)    |
+-------------------+
|  Data (Variable)  |
+-------------------+

```

> 헤더 크기가 **8바이트로 매우 작아**, 오버헤드가 적고 빠름

---

## 🔍 4. TCP vs UDP 비교 정리

| 구분 | **TCP** | **UDP** |
|:--|:--|:--|
| **연결 방식** | 연결형 (3-Way Handshake) | 비연결형 |
| **신뢰성** | 높음 (재전송, 순서 보장) | 낮음 (보장 X) |
| **속도** | 느림 (오버헤드 많음) | 빠름 (단순 구조) |
| **데이터 단위** | 세그먼트(Segment) | 데이터그램(Datagram) |
| **흐름 제어** | 지원 (윈도우 기반) | 없음 |
| **오류 제어** | 지원 (ACK, 재전송) | 없음 (손실 시 폐기) |
| **순서 보장** | 보장 | 미보장 |
| **혼잡 제어** | 있음 | 없음 |
| **대표 포트** | HTTP(80), HTTPS(443), FTP(21), SSH(22) | DNS(53), DHCP(67), RTP, 게임 |
| **적합한 서비스** | 파일 전송, 메일, 웹 등 | 스트리밍, 실시간 채팅, VoIP 등 |

---

## 🎯 5. TCP 헤더 구조 (주요 필드)

```

+---------------------------------------------------------------+
| Source Port | Destination Port | Sequence Number              |
+---------------------------------------------------------------+
| Acknowledgment Number                                         |
+---------------------------------------------------------------+
| Header Len | Flags | Window | Checksum | Urgent Pointer        |
+---------------------------------------------------------------+
| Options (Optional)                                            |
+---------------------------------------------------------------+
| Data                                                         |
+---------------------------------------------------------------+

```

| 필드 | 설명 |
|:--|:--|
| **Port 번호** | 송·수신 애플리케이션 식별 |
| **Sequence Number** | 데이터 순서 추적 |
| **ACK Number** | 수신 확인 응답 |
| **Flags** | 제어 비트 (SYN, ACK, FIN, RST 등) |
| **Window Size** | 흐름 제어용 버퍼 크기 |
| **Checksum** | 오류 검출 |

---

## 📡 6. TCP/UDP 포트 번호 예시

| 서비스 | 포트 | 프로토콜 |
|:--|:--|:--|
| HTTP | 80 | TCP |
| HTTPS | 443 | TCP |
| FTP | 21 | TCP |
| SSH | 22 | TCP |
| SMTP | 25 | TCP |
| DNS | 53 | UDP/TCP |
| DHCP | 67, 68 | UDP |
| SNMP | 161 | UDP |

---

## 🧠 7. 핵심 요약

| 구분 | TCP | UDP |
|:--|:--|:--|
| **형태** | 연결형 | 비연결형 |
| **신뢰성** | 보장 | 미보장 |
| **전송 속도** | 느림 | 빠름 |
| **사용 예시** | 웹, 파일 전송, 이메일 | 실시간 스트리밍, VoIP, 게임 |
| **오류/흐름 제어** | 지원 | 없음 |
| **순서 보장** | 있음 | 없음 |

---

## 🧾 8. 예시로 보는 차이

| 상황 | TCP | UDP |
|:--|:--|:--|
| **동영상 스트리밍** | 중간에 끊기거나 재전송으로 지연 발생 | 약간의 손실 무시하고 끊김 없이 재생 |
| **파일 다운로드** | 모든 데이터 정확히 받아야 함 (재전송 필수) | 일부 손실 시 파일 손상 가능 |
| **온라인 게임** | 지연보다 즉시 반응이 중요 (UDP 유리) | 패킷 재전송으로 입력 지연 발생 가능 |

---

> ✅ **한줄 요약:**  
> **TCP**는 "정확성"이 중요할 때,  
> **UDP**는 "속도"가 중요할 때 사용된다.  
> 즉, **신뢰성 vs 실시간성** 의 선택 문제다.
```

---