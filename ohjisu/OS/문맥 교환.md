### 📌 한줄 요약

- 직전까지 실행되던 프로세스를 재개하기 위해 기억해야 할 정보를 문맥이라고 한다.
- 프로세스 간에 실행을 전환하는 것을 문맥교환이라고 한다.

---

### **1. 문맥(Context)의 정의**

**문맥**은 특정 시점의 프로세스 상태를 나타내는 모든 데이터의 집합이다. 이 정보는 운영체제가 해당 프로세스를 다시 실행하기 위해 필요한 모든 것을 포함하며, 각 프로세스의 **프로세스 제어 블록(PCB)**에 저장된다.

* **주요 문맥 정보**:
    * **프로그램 카운터 (Program Counter)**: 다음에 실행할 명령어의 주소
    * **CPU 레지스터**: 현재 연산 중인 데이터와 상태를 담고 있는 모든 레지스터의 값
    * **프로세스 상태**: 준비(Ready), 대기(Waiting) 등 현재 프로세스의 상태
    * **메모리 관리 정보**: 해당 프로세스에 할당된 메모리 영역에 대한 정보 (예: 페이지 테이블 포인터)
    * **입출력 상태**: 프로세스에 할당된 파일이나 I/O 장치에 대한 정보

---

### **2. 문맥 교환의 과정**

문맥 교환은 다음과 같은 이벤트가 발생했을 때 운영체제 커널에 의해 촉발된다.
* **타임 슬라이스 만료**: 현재 프로세스에 할당된 실행 시간이 모두 소진되었을 때
* **인터럽트 발생**: I/O 장치의 작업 완료 등 외부 신호가 발생했을 때
* **시스템 호출**: 프로세스가 I/O 요청과 같이 커널의 서비스를 필요로 할 때

**[문맥 교환의 기술적 단계]**

1.  **트리거 발생 및 모드 전환**: 위의 이벤트가 발생하면, CPU는 사용자 모드(User Mode)에서 커널 모드(Kernel Mode)로 전환하여 운영체제에 제어권을 넘긴다.
2.  **현재 프로세스 문맥 저장**: 운영체제는 현재 실행 중인 프로세스(P1)의 문맥(레지스터 값, 프로그램 카운터 등)을 **P1의 PCB**에 저장한다.
3.  **프로세스 상태 변경**: P1의 상태를 준비(Ready) 또는 대기(Waiting) 상태로 변경한다.
4.  **다음 프로세스 선택**: 운영체제의 스케줄러가 준비 큐(Ready Queue)에서 다음에 실행할 프로세스(P2)를 선택한다.
5.  **다음 프로세스 문맥 복원**: 운영체제는 **P2의 PCB**에 저장되어 있던 문맥을 CPU의 레지스터로 불러온다.
6.  **모드 전환 및 실행 재개**: CPU는 다시 커널 모드에서 사용자 모드로 전환하고, 복원된 프로그램 카운터 위치부터 P2의 실행을 재개한다.

---

### **3. 문맥 교환의 비용 (Overhead)**

문맥 교환은 시스템이 멀티태스킹을 수행하기 위해 필수적이지만, 그 자체는 아무런 사용자 작업을 처리하지 않는 순수한 **오버헤드**이다.

* **직접 비용**: 레지스터 상태를 저장하고 복원하는 데 걸리는 시간.
* **간접 비용**: 문맥 교환 후, 새로운 프로세스의 데이터가 캐시 메모리에 적재되어 있지 않으므로 캐시 미스(Cache Miss)가 다수 발생한다. 이로 인해 초기 실행 속도가 저하될 수 있다.

**프로세스** 간의 문맥 교환은 독립된 메모리 영역을 전환하는 작업까지 포함하므로 비용이 매우 크다. 반면, 메모리 영역을 공유하는 **스레드** 간의 문맥 교환은 저장하고 복원할 정보가 적어 훨씬 가볍고 빠르다.