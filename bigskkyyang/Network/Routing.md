# 라우팅 (Routing)

---

## 개요

**데이터가 목적지까지 도달하기 위한 최적 경로를 결정하는 과정**  
- 패킷이 **여러 네트워크를 거쳐 전달될 때**, 어떤 경로로 보낼지를 결정하는 **네트워크 계층(OSI 3계층)** 의 핵심 기능

> 라우터(router)는 이러한 라우팅 기능을 수행하는 대표적인 장비

---

## 라우팅의 기본 개념

| 용어 | 설명 |
|:--|:--|
| **라우터 (Router)** | 네트워크 간 패킷을 전달하는 장비 |
| **라우팅 (Routing)** | 목적지까지의 최적 경로를 계산하는 과정 |
| **포워딩 (Forwarding)** | 실제 패킷을 다음 라우터로 전송하는 동작 |
| **라우팅 테이블 (Routing Table)** | 목적지 IP에 따른 다음 홉(Next Hop) 정보가 저장된 표 |

---

## 라우팅 테이블 (Routing Table)

라우터는 내부에 **라우팅 테이블**을 가지고 있음.  
각 테이블에는 네트워크 경로 정보가 저장되어 있음.

| 목적지 네트워크 | 서브넷 마스크 | 게이트웨이(Next Hop) | 인터페이스 | 메트릭 |
|:--|:--|:--|:--|:--:|
| 192.168.10.0 | 255.255.255.0 | 192.168.0.1 | eth0 | 1 |
| 10.0.0.0 | 255.0.0.0 | 10.0.0.2 | eth1 | 2 |
| 0.0.0.0 | 0.0.0.0 | 192.168.0.254 | eth0 | 10 |

- **0.0.0.0/0** → **기본 게이트웨이(Default Route)**  
  목적지를 찾을 수 없을 때 사용하는 경로  
  (즉, 인터넷 방향)

---

## 라우팅의 종류

### 1. 정적 라우팅 (Static Routing)

- 관리자가 **수동으로 경로를 지정**
- 작은 네트워크에서 단순하고 효율적
- 네트워크 구조 변경 시 **수동 수정 필요**

**장점**
- 설정 단순, CPU 부담 적음
- 안정적, 예측 가능한 동작

**단점**
- 대규모 네트워크에 비효율적
- 장애 발생 시 자동 복구 불가

**예시 명령어 (Cisco)**
Router(config)# ip route 192.168.2.0 255.255.255.0 192.168.1.2

---

### 2. 동적 라우팅 (Dynamic Routing)

- 라우터들이 **자동으로 경로 정보를 교환**하고 테이블을 갱신
- 네트워크 변화(링크 다운 등)에 자동으로 대응

**장점**
- 네트워크 확장성 높음
- 장애 발생 시 자동으로 우회 경로 설정

**단점**
- CPU, 메모리 사용량 증가
- 초기 설정 복잡함

---

## 동적 라우팅 프로토콜

| 구분 | 프로토콜 | 설명 | 거리 벡터 / 링크 상태 |
|:--:|:--|:--|:--|
| 내부 라우팅 (IGP) | **RIP** (Routing Information Protocol) | 홉 수 기반 거리 벡터 프로토콜 | 거리 벡터 |
|  | **OSPF** (Open Shortest Path First) | 링크 상태 기반, 대형 네트워크에 적합 | 링크 상태 |
|  | **EIGRP** (Enhanced IGRP, Cisco 전용) | 혼합형, 빠른 수렴 속도 | 하이브리드 |
| 외부 라우팅 (EGP) | **BGP** (Border Gateway Protocol) | 자율 시스템(AS) 간 라우팅 | 경로 벡터 |

---

## 내부 라우팅 (IGP) vs 외부 라우팅 (EGP)

| 구분 | IGP (Interior Gateway Protocol) | EGP (Exterior Gateway Protocol) |
|:--|:--|:--|
| 목적 | 내부 네트워크(조직 내부) 간 라우팅 | 다른 조직 간 라우팅 |
| 대표 프로토콜 | RIP, OSPF, EIGRP | BGP |
| 범위 | 한 조직 내부 | 인터넷 전체 |
| 관리 주체 | 단일 관리자 | 다수 관리자 (ISP 등) |

---

## 주요 동적 라우팅 알고리즘

### 1. 거리 벡터 알고리즘 (Distance Vector)
- 각 라우터가 인접 라우터로부터 **거리(홉 수)** 정보를 받아 경로 계산
- **RIP**에서 사용
- 느린 수렴, 루프 발생 가능

### 2. 링크 상태 알고리즘 (Link State)
- 모든 라우터가 **전체 네트워크의 구조를 인식**
- Dijkstra 알고리즘 사용
- **OSPF**에서 사용됨
- 빠르고 안정적

---

## 라우팅 우선순위 (Administrative Distance)

라우터는 여러 경로 중 “신뢰도”가 높은 경로를 선택

| 라우팅 종류 | AD 값 (낮을수록 우선) |
|:--|:--:|
| Directly Connected | 0 |
| Static Route | 1 |
| EIGRP | 90 |
| OSPF | 110 |
| RIP | 120 |
| Unknown / External | 255 (사용 안 함) |

---

## 기본 라우팅 과정 예시
[PC1] → [스위치] → [라우터1] → [라우터2] → [서버]

1. PC1이 서버 IP(203.0.113.10)로 패킷 전송  
2. 라우터1은 **라우팅 테이블 조회**  
3. 다음 홉(next hop)으로 라우터2 선택  
4. 라우터2가 최종 목적지 서브넷으로 전달  
5. 서버가 응답 패킷을 동일한 경로로 반환

---

## 라우팅 vs 포워딩

| 구분 | 라우팅 (Routing) | 포워딩 (Forwarding) |
|:--|:--|:--|
| 기능 | 경로 계산 | 실제 데이터 전송 |
| 수행 시점 | 사전 결정 | 실시간 수행 |
| 주체 | 라우터의 제어부 | 라우터의 데이터부 |
| 속성 | 소프트웨어적 | 하드웨어적 |

---