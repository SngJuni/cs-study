# 인터럽트 (Interrupt)

## 인터럽트란?

CPU의 작업을 방해하는 신호로 명령어 사이클이 끊어지는 상황을 의미함.
* 명령어 사이클 : 하나의 명령어를 처리하는 정형화된 흐름

1. 동기 인터럽트
   - CPU에 의해 발생하는 인터럽트로 **예외(exception)**이라고 부름
   - ex. CPU가 실행하는 프로그램상의 오류
2. 비동기 인터럽트
   - 주로 입출력 장치에 의해 발생하는 인터럽트로 **하드웨어 인터럽트**라고 부름
   - CPU가 요구한 작업을 마친 입출력 장치가 보내는 완료 알림
   - 입출력 장치가 입력을 받은 후 이를 처리하기 위한 입력 알림

---

## 인터럽트 처리 순서

1. 입출력장치가 cpu로 **인터럽트 요청 신호**를 보낸다.
2. 실행 사이클이 끝나고 명령어 인출 전 cpu 인터럽트 여부를 확인
3. 인터럽트 요청을 확인하고, **인터럽트 플래그**를 통해 현재 인터럽트를 받아들일 수 있는지 확인
4. 인터럽트를 받아들일 수 있다면 cpu는 현재 작업을 백업
5. **인터럽트 벡터**를 참조하여 **인터럽트 서비스 루틴**을 실행
6. 인터럽트 서비스 루틴이 끝나면 백업해 둔 작업을 복구하여 실행을 재개

*인터럽트 요청 신호*
인터럽트를 요청하는 신호. 인터럽트 요청을 수용하기 위해서는 플래그 레지스터의 인터럽트 플래그가 활성화되어 있어야 함.
 
*인터럽트 플래그*
하드웨어 인터럽트를 받아들일지 결정하는 플래그. 인터럽트 플래그가 비활성화되어 있다면 인터럽트 요청이 무시된다. 그러나 정전, 하드웨어 고장으로 인한 인터럽트 등 막을 수 없는 인터럽트는 우선순위가 높아 플래그에 관계없이 인터럽트가 받아들여진다.
 
*인터럽트 서비스 루틴 (ISR)*
인터럽트를 처리하기 위한 프로그램으로 인터럽트를 처리하는 방법이 담겨 있음. 인터럽트 핸들러라고도 불림. cpu가 인터럽트를 처리한다는 것은 인터럽트 서비스 루틴을 실행하고 이전작업으로 다시 돌아온다는 것을 의미한다.

*인터럽트 벡터*
인터럽트 서비스 루틴을 식별하기 위한 정보. 인터럽트 벡터로 서비스 루틴의 시작 주소를 알 수 있다.

---

## Polling 방식 (바쁜 대기)

루프를 계속 돌며 시그널이 들어왔는지 확인하는 방식

구현이 쉽지만, 시스템 자원을 많이 사용함

---

### 하드웨어 인터럽트

주로 입출력 장치에 의해 발생하는 인터럽트

### 소프트웨어 인터럽트

프로그램 코드 혹은 운영체제의 명령어로 발생하는 인터럽트

동기화 방식으로 작동함

---

## 인터럽트 동시 발생

1. 인터럽트 요청 중 가장 높은 우선순위를 가진 인터럽트 식별
2. 현재 작업 중인 작업의 상태를 저장
3. 우선순위 순서대로 인터럽트 서비스 루틴 혹은 인터럽트 핸들러 실행
4. 처리 중 더 높은 우선순위의 인터럽트가 발생한다면 해당 인터럽트가 처리됨
5. 모두 완료되었다면 이전에 저장한 작업을 복원하여 작업 재개

---